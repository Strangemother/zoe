/* 
 * zoe.js 0.0.1
 * http://zoejs.org
 */(function(e,t){typeof exports=="object"?module.exports=t():typeof define=="function"&&define.amd?define(function(){return t()}):e.zoe=t()})(this,function(){var e={},t=typeof window!="undefined"?window.console=window.console||{}:global.console;t.dir=t.dir||function(){},t.log=t.log||function(){};var n=e.fn=function(e,t){if(typeof e=="function"||typeof e=="string")t=e,e=null;var u=function(){return u.run(u._this||this,Array.prototype.splice.call(arguments,0),u.fns)};return u.constructor=n,u.fns=e||[],u.run=(typeof t=="string"?n[t]:t)||n.LAST_DEFINED,u.on=i,u.off=s,u.first=o,u._this=undefined,u.bind=r,u},r=function(e){return this._this=e,this},i=function(e){return this.fns.push(e),this},s=function(e){if(!e){this.fns=[];return}for(var t=0;t<this.fns.length;t++)if(this.fns[t]==e){this.fns.splice(t,1);return}},o=function(e){return this.fns=[e].concat(this.fns),this};n.executeReduce=function(e,t){return t===undefined&&(t=e,e=undefined),typeof e=="function"&&(e=e()),function(n,r,i){var s=e;for(var o=0;o<i.length;o++)s=t(s,i[o].apply(n,r));return s}};var u=n.LAST_DEFINED=n.executeReduce(function(e,t){return t!==undefined?t:e});n.STOP_DEFINED=function(t,n,r){var i;for(var s=0;s<r.length;s++){i=r[s].apply(t,n);if(i!==undefined)return i}return i};var a=typeof process!="undefined"&&process.nextTick;n.ASYNC=n.ASYNC_NEXT=function(t,n,r){var i=0,s;typeof n[n.length-1]=="function"&&(s=n.pop());var o=function(e){return function(){r[e]?r[e].length>=n.length+1?a?a(function(){r[e].apply(t,n.concat([o(e+1)]))}):r[e].apply(t,n.concat([o(e+1)])):(r[e].apply(t,n),o(e+1)()):s&&s()}};return o(0)()},n.ASYNC_SIM=function(t,n,r){var i=0,s;typeof n[n.length-1]=="function"&&(s=n.pop());for(var o=0;o<r.length;o++)r[o].apply(t,n.concat([function(){++i==r.length&&s()}]))},e.on=function(e,t,r){var i=e[t];if(!i||i.constructor!=n||i.run!=n.LAST_DEFINED)e[t]=n(i?[i]:[]);e[t].on(r)},e.off=function(e,t,r){if(e[t].constructor==n)return e[t].off(r)};var f=e.extend=function(n,r,i){n=n||{};var s=arguments;s.length>2&&(i=s[s.length-1]);var o;typeof i=="object"?(o=i,i=undefined):i||(r._extend&&(n._extend=f(n._extend||{},r._extend,"REPLACE")),o=n._extend);if(o)for(var u in o){var a=u.indexOf(".");if(a!=-1){var l=u.substr(0,a);o[l]||(o[l]=f)}}for(var u in r)if(!r.hasOwnProperty||r.hasOwnProperty(u)){if(u=="_extend")continue;var c=r[u],h,p=u.length,d=u.substr(0,2)=="__",v=u.substr(p-2,2)=="__",m=d&&!v&&(u=u.substr(2))&&f.APPEND||!d&&v&&(u=u.substr(0,p-2))&&f.PREPEND||d&&v&&(u=u.substr(2,p-4))&&f.REPLACE,g=m||i||o&&(o[u]||o["*"])||f.DEFINE;typeof g=="string"&&(g=f[g]);try{h=g(n[u],c,o&&f.deriveRules(o,u))}catch(y){throw t.dir(n),t.dir(r),t.dir(f.deriveRules(i,u)),'zoe.extend: "'+u+'" override error. \n ->'+(y.message||y)}h!==undefined&&(n[u]=h)}if(s.length>3){var b=[n];b.concat(Array.prototype.splice.call(s,2,s.length-3,s.length-3)),b.push(i),$z.extend.apply(this,b)}return n};f.EXTEND=f,f.DEFINE=function(t,n){if(t!==undefined)throw"No override specified.";return n},f.REPLACE=function(t,n){return n!==undefined?n:t},f.FILL=function(t,n){return t===undefined?n:t},f.IGNORE=function(){};var l=function(e){return e!=null&&e.constructor==Object},c=function(e){return typeof e=="function"},h=function(e){return typeof e=="string"},p=function(e){return e instanceof Array},d=function(e,t){return e?typeof e=="string"?e:(e&&!e["*"]&&(e["*"]=t),e):t};f.APPEND=function(t,n,r){return l(n)?f(l(t)?t:{},n,d(r,"REPLACE")):c(n)?f.CHAIN(t,n):h(n)?f.STR_APPEND(t,n):p(n)?f.ARR_APPEND(t,n):n},f.PREPEND=function(t,n,r){return l(n)&&(t===undefined||l(t))?f(t||{},n,d(r,"FILL")):c(n)?f.CHAIN_FIRST(t,n):h(n)?f.STR_PREPEND(t,n):p(n)?f.ARR_PREPEND(t,n):t===undefined?n:t},f.DAPPEND=function(t,n,r){return f.APPEND(t,n,d(r,"DAPPEND"))},f.DPREPEND=function(n,r,i){return e.extend.PREPEND(n,r,d(i,"DPREPEND"))},f.DREPLACE=function(t,n,r){return l(n)?f(t||{},n,d(r,"DREPLACE")):is_array(n)?f(t||[],n,d(r,"DREPLACE")):n},f.DFILL=function(t,n,r){return l(n)?f(t||{},n,d(r,"DFILL")):typeof t=="undefined"?n:t},f.ARR_APPEND=function(t,n){return t=t||[],t.concat||(t=[t]),t.concat(n)},f.ARR_PREPEND=function(t,n){return n=n||[],n.concat||(n=[n]),n.concat(t||[])},f.STR_APPEND=function(t,n){return t?t+n:n},f.STR_PREPEND=function(t,n){return n+t},f.deriveRules=function(e,t){var n;for(var r in e){if(r=="*")continue;var i=r.split(".");if(i[0]==t||i[0]=="*")n=n||{},n[i.splice(1).join(".")]=e[r]}return n},f.makeChain=function(e,t){return typeof e=="string"&&(e=n[e]),function(r,i){if(!r||r.constructor!=n||r.run!=e)r=n(r?[r]:[],e);return t?r.first(i):r.on(i),r}},f.CHAIN=f.makeChain(n.LAST_DEFINED),f.CHAIN_FIRST=f.makeChain(n.LAST_DEFINED,!0),f.CHAIN_STOP_DEFINED=f.makeChain(n.STOP_DEFINED),f.CHAIN_ASYNC=f.makeChain(n.ASYNC),e.create=function(e,t){t=m(e,t),t._definition&&(t=t._definition);var r;v(t,function(e){if(e._base)return r=e._base(t),!0}),r=r||{},r._definition=t,r._extend={_base:f.IGNORE,_implement:f.IGNORE,_reinherit:f.IGNORE,_make:f.IGNORE,_integrate:f.IGNORE,_built:f.IGNORE};var i=[],s=n(),o=n();return o._this=s._this=r,v(t,function(n){n=o(n,t)||n,n._integrate&&o.on(n._integrate),f(r,n),n._make&&n._make.call(r,t,n),n._built&&s.on(n._built),i.push(n)},function(t){return i.indexOf(t)!=-1&&!t._reinherit}),s(t),r};var v=function(e,n,r){r=r||function(){};if(e._implement)for(var i=0,s=e._implement.length;i<s;i++){var o=e._implement[i];o||(t.dir(e),t.log("Implementor not defined!")),o._definition&&(o=o._definition);if(r(o))continue;if(v(o,n,r))return!0}return n(e)},m=function(e,t){return e instanceof Array||(t=e,e=[]),t=t||{},t._implement=e.concat(t._implement||[]),t};return e.inherits=function(t,n){if(t._definition)return e.inherits(t._definition,n);if(n._definition)return e.inherits(t,n._definition);var r=!1;return v(t,function(e){if(e===n)return r=!0,!0}),r},e.Constructor={_base:function(e){function t(){t.construct&&t.construct.apply(this,arguments)}return t},_extend:{prototype:f,construct:f.CHAIN},_integrate:function(e){if(typeof e=="function"&&!e._definition)return{construct:e,prototype:e.prototype};var t=Object.getOwnPropertyDescriptor;if(t){var n=t(e,"prototype");n&&!n.enumerable&&f(this.prototype,e.prototype,f.deriveRules(this._extend,"prototype"))}}},e.InstanceEvents={_extend:{_events:"ARR_APPEND"},construct:function(){var t=this.constructor._events;if(!t)return;for(var n=0;n<t.length;n++){var r=t[n];this[r]=e.fn(this[r]?[this[r]]:[]).bind(this)}}},e});